{% extends "base.html" %}

{% block title %}Perfil de Usuario{% endblock %}

{% block content %}

{% load static %}


<main class="max-w-[1280px] w-full mx-auto px-10 py-8">

    <div class="mb-10">
        <h1 class="text-[#0d141b] dark:text-white text-4xl font-black leading-tight tracking-[-0.033em] mb-3">
            Proponer Nuevo Activo Comunitario
        </h1>
        <p class="text-[#4c739a] text-lg font-normal max-w-2xl">
            Ayúdanos a mapear los recursos que apoyan la salud y el bienestar en nuestra comunidad.
            Tu propuesta será revisada para verificar su alineación con el modelo MAIS.
        </p>
    </div>

    {% if messages %}
    <div class="mb-6 space-y-3">
        {% for message in messages %}
        <div class="flex items-center p-4 rounded-xl border shadow-sm transition-all animate-in fade-in slide-in-from-top-4 
        {% if message.tags == 'success' %}
            bg-emerald-50 border-emerald-200 text-emerald-800 dark:bg-emerald-900/20 dark:border-emerald-800 dark:text-emerald-400
        {% else %}
            bg-red-50 border-red-200 text-red-800 dark:bg-red-900/20 dark:border-red-800 dark:text-red-400
        {% endif %}">
            <span class="material-symbols-outlined mr-3">
                {% if message.tags == 'success' %}check_circle{% else %}error{% endif %}
            </span>
            <p class="font-medium text-sm md:text-base">{{ message }}</p>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <form method="POST" action="{% url 'add_assets' %}" class="space-y-10">
        {% csrf_token %}

        <section
            class="bg-white dark:bg-background-dark p-8 rounded-xl shadow-sm border border-[#e7edf3] dark:border-slate-800">
            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">description</span>
                Información del Activo
            </h3>

            <div class="grid grid-cols-1 gap-6">
                <div class="flex flex-col">
                    <label class="text-base font-semibold pb-2">Nombre del Activo <span
                            class="text-red-500">*</span></label>
                    <input name="nombre"
                        class="form-input w-full rounded-lg border border-[#cfdbe7] dark:border-slate-700 bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                        placeholder="Centro Comunitario Las Flores" required>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex flex-col">
                        <label class="text-base font-semibold pb-2">Tipo de Activo</label>
                        <select name="tipo_activo"
                            class="form-input w-full rounded-lg border border-[#cfdbe7] dark:border-slate-700 bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base">
                            <option disabled selected value="">Seleccione tipo...</option>
                            {% for val, label in ComunityAsset.TIPO_ACTIVO_CHOICES %}
                            <option value="{{ val }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="flex flex-col">
                        <label class="text-base font-semibold pb-2">Categoría MAIS</label>
                        <select name="categoria_mais"
                            class="form-input w-full rounded-lg border border-[#cfdbe7] dark:border-slate-700 bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base">
                            <option disabled selected value="">Seleccione categoría...</option>
                            <option value="promocion">Promoción de la Salud</option>
                            <option value="prevencion">Prevención de Enfermedades</option>
                            <option value="recuperacion">Recuperación y Rehabilitación</option>
                            <option value="participacion">Participación Social</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="flex flex-col">
                        <label class="text-base font-semibold pb-2">Dirección</label>
                        <input name="direccion"
                            class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                            placeholder="Av. Principal 123">
                    </div>
                    <div class="flex flex-col">
                        <label class="text-base font-semibold pb-2">Región</label>
                        <input name="region"
                            class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                            placeholder="Valparaíso">
                    </div>
                    <div class="flex flex-col">
                        <label class="text-base font-semibold pb-2">Comuna</label>
                        <input name="comuna"
                            class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                            placeholder="Quilpué">
                    </div>
                </div>

                <div class="flex flex-col">
                    <label class="text-base font-semibold pb-2">Horario de Funcionamiento</label>
                    <input name="horario"
                        class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                        placeholder="Lunes a Viernes 08:00 - 20:00">
                </div>

                <div class="flex flex-col">
                    <label class="text-base font-semibold pb-2">Descripción</label>
                    <textarea name="descripcion"
                        class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 min-h-[120px] p-4 text-base"
                        placeholder="Describe el activo..."></textarea>
                </div>
            </div>
        </section>

        <section
            class="bg-white dark:bg-background-dark p-8 rounded-xl shadow-sm border border-[#e7edf3] dark:border-slate-800">
            <h3 class="text-xl font-bold mb-6 flex items-center gap-3">
                <div class="flex -space-x-2">
                    <span
                        class="material-symbols-outlined text-primary bg-primary/10 p-2 rounded-full ring-2 ring-white dark:ring-slate-800 me-5">payments   </span>
                    <span
                        class="material-symbols-outlined text-primary bg-primary/10 p-2 rounded-full ring-2 ring-white dark:ring-slate-800">door_front</span>
                </div>
                Acceso y Financiamiento
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-6">
                    <div class="flex flex-col">
                        <label class="text-base font-semibold pb-2">Tipo de Financiamiento</label>
                        <select name="tipo_financiamiento"
                            class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base">
                            <option value="gratuito">Gratuito / Público</option>
                            <option value="copago">Copago / Fonasa</option>
                            <option value="pago">Privado / De Pago</option>
                            <option value="donacion">Aporte Voluntario / Donación</option>
                        </select>
                    </div>

                    <div class="flex flex-col">
                        <label class="text-base font-semibold pb-2">Población Objetivo</label>
                        <select name="poblacion_objetivo"
                            class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base">
                            <option value="general">Público General</option>
                            <option value="ninos">Niños y Adolescentes</option>
                            <option value="adulto_mayor">Personas Mayores</option>
                            <option value="mujeres">Mujeres / Gestantes</option>
                            <option value="migrantes">Población Migrante</option>
                            <option value="discapacidad">Personas con Discapacidad</option>
                        </select>
                    </div>

                    <div class="flex items-center gap-3 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg">
                        <input type="checkbox" name="requiere_inscripcion" id="requiere_inscripcion"
                            class="w-5 h-5 text-primary rounded border-gray-300">
                        <label for="requiere_inscripcion"
                            class="text-sm font-semibold text-blue-900 dark:text-blue-300 italic">¿Requiere inscripción
                            previa o pertenecer a un sector?</label>
                    </div>
                </div>

                <div
                    class="bg-slate-50 dark:bg-slate-900/40 p-6 rounded-xl border border-dashed border-slate-300 dark:border-slate-700">
                    <p class="text-sm font-bold uppercase tracking-wider text-slate-400 mb-4">Accesibilidad y Servicios
                    </p>

                    <div class="grid grid-cols-1 gap-4">
                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input type="checkbox" name="accesibilidad_silla_ruedas"
                                class="w-5 h-5 text-primary rounded border-gray-300">
                            <span class="flex items-center gap-2 text-slate-700 dark:text-slate-300 font-medium">
                                <span class="material-symbols-outlined text-lg">accessible</span> Rampa / Acceso Silla
                                de Ruedas
                            </span>
                        </label>

                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input type="checkbox" name="baño_accesible"
                                class="w-5 h-5 text-primary rounded border-gray-300">
                            <span class="flex items-center gap-2 text-slate-700 dark:text-slate-300 font-medium">
                                <span class="material-symbols-outlined text-lg">wc</span> Baño Adaptado
                            </span>
                        </label>

                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input type="checkbox" name="accesibilidad_visual"
                                class="w-5 h-5 text-primary rounded border-gray-300">
                            <span class="flex items-center gap-2 text-slate-700 dark:text-slate-300 font-medium">
                                <span class="material-symbols-outlined text-lg">visibility</span> Señalética Braille o
                                Sonora
                            </span>
                        </label>

                        <hr class="border-slate-200 dark:border-slate-800 my-1">

                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input type="checkbox" name="estacionamiento_general"
                                class="w-5 h-5 text-primary rounded border-gray-300">
                            <span class="flex items-center gap-2 text-slate-700 dark:text-slate-300 font-medium">
                                <span class="material-symbols-outlined text-lg">local_parking</span> Estacionamiento
                                General
                            </span>
                        </label>

                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input type="checkbox" name="estacionamiento_discapacidad"
                                class="w-5 h-5 text-primary rounded border-gray-300">
                            <span class="flex items-center gap-2 text-slate-700 dark:text-slate-300 font-medium">
                                <span class="material-symbols-outlined text-lg">accessible_forward</span>
                                Estacionamiento Discapacidad
                            </span>
                        </label>
                    </div>
                </div>
            </div>
        </section>

        <section
            class="bg-white dark:bg-background-dark p-8 rounded-xl shadow-sm border border-[#e7edf3] dark:border-slate-800">
            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">contact_page</span>
                Información de Contacto
            </h3>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="flex flex-col">
                    <label class="text-base font-semibold pb-2">Nombre de Responsable</label>
                    <input name="contacto_nombre"
                        class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                        placeholder="Juan Pérez">
                </div>
                <div class="flex flex-col">
                    <label class="text-base font-semibold pb-2">Correo Electrónico</label>
                    <input type="email" name="contacto_email"
                        class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                        placeholder="contacto@ejemplo.cl">
                </div>
                <div class="flex flex-col">
                    <label class="text-base font-semibold pb-2">Teléfono de Contacto</label>
                    <input type="text" name="contacto_fono"
                        class="form-input w-full rounded-lg border border-[#cfdbe7] bg-slate-50 dark:bg-slate-900 h-14 p-4 text-base"
                        placeholder="+56 9 ...">
                </div>
            </div>
        </section>

        <section
            class="bg-white dark:bg-background-dark p-8 rounded-xl shadow-sm border border-[#e7edf3] dark:border-slate-800">
            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">location_on</span>
                Ubicación del Activo
            </h3>

            aca podria ir una explicacion de seleccionar la wea en el mapa

            <div class="relative">
                <div id="map" class="w-full h-[400px] rounded-lg border border-[#cfdbe7] z-0"></div>
                <button type="button" id="locate-btn"
                    class="absolute top-4 right-4 z-[1000] bg-white dark:bg-slate-800 border border-[#cfdbe7] dark:border-slate-700 shadow-md rounded-lg px-3 py-2 flex items-center gap-2 hover:bg-slate-100 transition">
                    <span class="material-symbols-outlined text-primary text-sm">my_location</span>
                    <span class="text-sm font-medium">Mi ubicación</span>
                </button>
            </div>

            <div class="mt-6 grid grid-cols-2 gap-4">
                <div class="bg-slate-50 p-3 rounded-lg border border-[#cfdbe7]">
                    <p class="text-xs font-bold text-slate-400">Latitud</p>
                    <p id="latitude_display" class="font-mono text-slate-700">-33.4489</p>
                </div>
                <div class="bg-slate-50 p-3 rounded-lg border border-[#cfdbe7]">
                    <p class="text-xs font-bold text-slate-400">Longitud</p>
                    <p id="longitude_display" class="font-mono text-slate-700">-70.6693</p>
                </div>
            </div>

            <input type="hidden" name="latitude" id="latitude" value="-33.4489">
            <input type="hidden" name="longitude" id="longitude" value="-70.6693">
        </section>

        <div class="flex justify-end gap-4 pb-10">
            <button type="reset"
                class="px-8 h-14 rounded-lg border border-[#cfdbe7] font-bold hover:bg-slate-100 transition-colors">
                Limpiar Formulario
            </button>
            <button type="submit"
                class="px-10 h-14 rounded-lg bg-primary text-white font-bold shadow-lg hover:bg-primary/90 flex items-center gap-2 transition-all">
                Enviar Propuesta
                <span class="material-symbols-outlined">send</span>
            </button>
        </div>
    </form>
</main>

<script src="{% static 'js/add_assets.js' %}"></script>


{% endblock %}